"use strict";(self.webpackChunkchurchvest_v2=self.webpackChunkchurchvest_v2||[]).push([[745],{8745:(rn,T,a)=>{a.r(T),a.d(T,{ReportingModule:()=>tn});var m=a(8583),d=a(4655),e=a(7716);let N=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-financial-journal"]],decls:2,vars:0,template:function(t,i){1&t&&(e.TgZ(0,"p"),e._uU(1,"financial-journal works!"),e.qZA())},styles:[""]}),n})();var U=a(8259),C=a.n(U),g=a(3974),_=a(9222),k=a(449),A=a(6087),b=a(5304),M=a(2592),J=a(2340),O=a(1841),S=a(7556);let v=(()=>{class n{constructor(t,i){this.http=t,this.authService=i,this.authService.getChurchSlug()}fetchMembershipJournal(t,i){return this.http.get(`${J.N.managementbaseUrl}/${this.authService.getChurchSlug()}/reporting/${t}/?date=${i}`).pipe((0,b.K)(M.S))}fetchJournal(t,i){return this.http.get(`${J.N.managementbaseUrl}/${this.authService.getChurchSlug()}/reporting/${t}/?date=${i}`).pipe((0,b.K)(M.S))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(O.eN),e.LFG(S.e))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var q=a(1641),w=a(7423),f=a(5245),u=a(7322),y=a(115),s=a(6856),Q=a(2118),p=a(5086);function Y(n,o){1&n&&(e.ynx(0),e._UZ(1,"app-loading-roller"),e.BQk())}function E(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",19),e.TgZ(2,"div",20),e.TgZ(3,"h3",21),e._uU(4,"Regular Members"),e.qZA(),e.TgZ(5,"div",22),e.TgZ(6,"span"),e.TgZ(7,"mat-icon"),e._uU(8,"more_horiz"),e.qZA(),e.qZA(),e.TgZ(9,"mat-menu",null,23),e.TgZ(11,"button",24),e.NdJ("click",function(){return e.CHM(t),e.oxw().onPreview("reg_members")}),e._uU(12," Preview "),e.qZA(),e.TgZ(13,"button",24),e.NdJ("click",function(){return e.CHM(t),e.oxw()._printElement("print-reg-members")}),e._uU(14," Print "),e.qZA(),e.TgZ(15,"button",25),e._uU(16,"Download as Excel"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(17,"div",26),e.TgZ(18,"p",27),e._uU(19," View and download report of the regular members for the period selected "),e.qZA(),e.qZA(),e.qZA(),e.BQk()}if(2&n){const t=e.MAs(10);e.xp6(5),e.Q6J("mat-menu-trigger-for",t)}}function B(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",19),e.TgZ(2,"div",20),e.TgZ(3,"h3",21),e._uU(4,"First Timers"),e.qZA(),e.TgZ(5,"div",22),e.TgZ(6,"span"),e.TgZ(7,"mat-icon"),e._uU(8,"more_horiz"),e.qZA(),e.qZA(),e.TgZ(9,"mat-menu",null,23),e.TgZ(11,"button",24),e.NdJ("click",function(){return e.CHM(t),e.oxw().onPreview("first-timer")}),e._uU(12," Preview "),e.qZA(),e.TgZ(13,"button",24),e.NdJ("click",function(){return e.CHM(t),e.oxw()._printElement("print-first-timer")}),e._uU(14," Print "),e.qZA(),e.TgZ(15,"button",25),e._uU(16,"Download as Excel"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(17,"div",26),e.TgZ(18,"p",27),e._uU(19,"See in detail the number of first timers."),e.qZA(),e.qZA(),e.qZA(),e.BQk()}if(2&n){const t=e.MAs(10);e.xp6(5),e.Q6J("mat-menu-trigger-for",t)}}function I(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",19),e.TgZ(2,"div",20),e.TgZ(3,"h3",21),e._uU(4,"New Converts"),e.qZA(),e.TgZ(5,"div",22),e.TgZ(6,"span"),e.TgZ(7,"mat-icon"),e._uU(8,"more_horiz"),e.qZA(),e.qZA(),e.TgZ(9,"mat-menu",null,23),e.TgZ(11,"button",24),e.NdJ("click",function(){return e.CHM(t),e.oxw().onPreview("new-convert")}),e._uU(12," Preview "),e.qZA(),e.TgZ(13,"button",24),e.NdJ("click",function(){return e.CHM(t),e.oxw()._printElement("print-new-convert")}),e._uU(14," Print "),e.qZA(),e.TgZ(15,"button",25),e._uU(16,"Download as Excel"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(17,"div",26),e.TgZ(18,"p",27),e._uU(19," See in detail of the newly converted souls in church. "),e.qZA(),e.qZA(),e.qZA(),e.BQk()}if(2&n){const t=e.MAs(10);e.xp6(5),e.Q6J("mat-menu-trigger-for",t)}}function D(n,o){1&n&&e.GkF(0)}function F(n,o){if(1&n&&(e.ynx(0),e.YNc(1,D,1,0,"ng-container",28),e.BQk()),2&n){e.oxw();const t=e.MAs(34);e.xp6(1),e.Q6J("ngTemplateOutlet",t)}}function P(n,o){1&n&&e.GkF(0)}function L(n,o){if(1&n&&(e.ynx(0),e.YNc(1,P,1,0,"ng-container",28),e.BQk()),2&n){e.oxw();const t=e.MAs(36);e.xp6(1),e.Q6J("ngTemplateOutlet",t)}}function R(n,o){1&n&&e.GkF(0)}function j(n,o){if(1&n&&(e.ynx(0),e.YNc(1,R,1,0,"ng-container",28),e.BQk()),2&n){e.oxw();const t=e.MAs(38);e.xp6(1),e.Q6J("ngTemplateOutlet",t)}}function $(n,o){if(1&n&&(e.TgZ(0,"th",40),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t," ")}}function H(n,o){if(1&n&&(e.TgZ(0,"td",42),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.qZA()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.user.first_name)}}function z(n,o){1&n&&(e.ynx(0),e.YNc(1,H,3,1,"td",41),e.BQk())}function V(n,o){if(1&n&&(e.TgZ(0,"td",43),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.qZA()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.user.last_name)}}function K(n,o){1&n&&(e.ynx(0),e.YNc(1,V,3,1,"td",39),e.BQk())}const Z=function(n,o){return{green:n,purple:o}};function W(n,o){if(1&n&&(e.TgZ(0,"td",43),e.TgZ(1,"span",44),e._uU(2),e.qZA(),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngClass",e.WLB(2,Z,"admin"==t.role,"member"==t.role)),e.xp6(1),e.Oqu(t.role)}}function G(n,o){1&n&&(e.ynx(0),e.YNc(1,W,3,5,"td",39),e.BQk())}function X(n,o){if(1&n&&(e.TgZ(0,"td",43),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.qZA()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.user.phone?t.user.phone:"---")}}function ee(n,o){1&n&&(e.ynx(0),e.YNc(1,X,3,1,"td",39),e.BQk())}function ne(n,o){if(1&n&&(e.TgZ(0,"td",43),e.TgZ(1,"span",45),e._uU(2),e.qZA(),e.qZA()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.user.email?t.user.email:"---")}}function te(n,o){1&n&&(e.ynx(0),e.YNc(1,ne,3,1,"td",39),e.BQk())}function oe(n,o){if(1&n&&(e.TgZ(0,"td",43),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.qZA()),2&n){const t=o.$implicit,i=e.oxw().$implicit,r=e.oxw(3);e.xp6(2),e.hij(" ",t[r._concatColumnString(i)],"")}}function ie(n,o){if(1&n&&(e.ynx(0,37),e.YNc(1,$,2,1,"th",38),e.YNc(2,z,2,0,"ng-container",14),e.YNc(3,K,2,0,"ng-container",14),e.YNc(4,G,2,0,"ng-container",14),e.YNc(5,ee,2,0,"ng-container",14),e.YNc(6,te,2,0,"ng-container",14),e.YNc(7,oe,3,1,"td",39),e.BQk()),2&n){const t=o.$implicit,i=o.index;e.Q6J("matColumnDef",t),e.xp6(2),e.Q6J("ngIf",0===i),e.xp6(1),e.Q6J("ngIf","last name"==t),e.xp6(1),e.Q6J("ngIf","role"==t),e.xp6(1),e.Q6J("ngIf","phone"==t),e.xp6(1),e.Q6J("ngIf","email"==t)}}function re(n,o){1&n&&e._UZ(0,"tr",46)}const h=function(n){return{"bg-wrap":n}};function ae(n,o){if(1&n&&e._UZ(0,"tr",47),2&n){const t=o.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.VKq(1,h,i.selection.isSelected(t)))}}function _e(n,o){if(1&n&&(e.TgZ(0,"tr",48),e.TgZ(1,"td",49),e._uU(2),e.qZA(),e.qZA()),2&n){const t=e.oxw(3);e.xp6(2),e.hij(' No data matching the search item: "',t.filterValue,'" ')}}function ce(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"table",32),e.YNc(2,ie,8,6,"ng-container",33),e.YNc(3,re,1,0,"tr",34),e.YNc(4,ae,1,3,"tr",35),e.YNc(5,_e,3,1,"tr",36),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("dataSource",t.dataSource),e.xp6(1),e.Q6J("ngForOf",t.displayedColumns),e.xp6(1),e.Q6J("matHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns)}}const x=function(n){return{hidden:n}};function se(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",29),e.TgZ(1,"div",30),e.YNc(2,ce,6,4,"ng-container",14),e.TgZ(3,"mat-paginator",31),e.NdJ("page",function(r){return e.CHM(t),e.oxw().pageChanged(r)}),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",0!==t.regularMemberList.length),e.xp6(1),e.Q6J("pageIndex",t.currentPage)("pageSize",t.pageSize)("ngClass",e.VKq(4,x,0==t.regularMemberList.length))}}function le(n,o){if(1&n&&(e.TgZ(0,"th",40),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t," ")}}function me(n,o){if(1&n&&(e.TgZ(0,"td",42),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.qZA()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.user.first_name)}}function pe(n,o){1&n&&(e.ynx(0),e.YNc(1,me,3,1,"td",41),e.BQk())}function ge(n,o){if(1&n&&(e.TgZ(0,"td",43),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.qZA()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.user.last_name)}}function ue(n,o){1&n&&(e.ynx(0),e.YNc(1,ge,3,1,"td",39),e.BQk())}function de(n,o){if(1&n&&(e.TgZ(0,"td",43),e.TgZ(1,"span",44),e._uU(2),e.qZA(),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngClass",e.WLB(2,Z,"admin"==t.role,"member"==t.role)),e.xp6(1),e.Oqu(t.role)}}function fe(n,o){1&n&&(e.ynx(0),e.YNc(1,de,3,5,"td",39),e.BQk())}function Ze(n,o){if(1&n&&(e.TgZ(0,"td",43),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.qZA()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.user.phone?t.user.phone:"---")}}function he(n,o){1&n&&(e.ynx(0),e.YNc(1,Ze,3,1,"td",39),e.BQk())}function xe(n,o){if(1&n&&(e.TgZ(0,"td",43),e.TgZ(1,"span",45),e._uU(2),e.qZA(),e.qZA()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.user.email?t.user.email:"---")}}function Te(n,o){1&n&&(e.ynx(0),e.YNc(1,xe,3,1,"td",39),e.BQk())}function Ce(n,o){if(1&n&&(e.TgZ(0,"td",43),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.qZA()),2&n){const t=o.$implicit,i=e.oxw().$implicit,r=e.oxw(3);e.xp6(2),e.hij(" ",t[r._concatColumnString(i)],"")}}function Ae(n,o){if(1&n&&(e.ynx(0,37),e.YNc(1,le,2,1,"th",38),e.YNc(2,pe,2,0,"ng-container",14),e.YNc(3,ue,2,0,"ng-container",14),e.YNc(4,fe,2,0,"ng-container",14),e.YNc(5,he,2,0,"ng-container",14),e.YNc(6,Te,2,0,"ng-container",14),e.YNc(7,Ce,3,1,"td",39),e.BQk()),2&n){const t=o.$implicit,i=o.index;e.Q6J("matColumnDef",t),e.xp6(2),e.Q6J("ngIf",0===i),e.xp6(1),e.Q6J("ngIf","last name"==t),e.xp6(1),e.Q6J("ngIf","role"==t),e.xp6(1),e.Q6J("ngIf","phone"==t),e.xp6(1),e.Q6J("ngIf","email"==t)}}function be(n,o){1&n&&e._UZ(0,"tr",46)}function Me(n,o){if(1&n&&e._UZ(0,"tr",47),2&n){const t=o.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.VKq(1,h,i.selection.isSelected(t)))}}function Je(n,o){if(1&n&&(e.TgZ(0,"tr",48),e.TgZ(1,"td",49),e._uU(2),e.qZA(),e.qZA()),2&n){const t=e.oxw(3);e.xp6(2),e.hij(' No data matching the search item: "',t.filterValue,'" ')}}function ve(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"table",50),e.YNc(2,Ae,8,6,"ng-container",33),e.YNc(3,be,1,0,"tr",34),e.YNc(4,Me,1,3,"tr",35),e.YNc(5,Je,3,1,"tr",36),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("dataSource",t.dataSource),e.xp6(1),e.Q6J("ngForOf",t.displayedColumns),e.xp6(1),e.Q6J("matHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns)}}function qe(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",29),e.TgZ(1,"div",30),e.YNc(2,ve,6,4,"ng-container",14),e.TgZ(3,"mat-paginator",31),e.NdJ("page",function(r){return e.CHM(t),e.oxw().pageChanged(r)}),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",0!==t.firstTimersList.length),e.xp6(1),e.Q6J("pageIndex",t.currentPage)("pageSize",t.pageSize)("ngClass",e.VKq(4,x,0==t.firstTimersList.length))}}function we(n,o){if(1&n&&(e.TgZ(0,"th",40),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t," ")}}function ye(n,o){if(1&n&&(e.TgZ(0,"td",42),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.qZA()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.user.first_name)}}function Qe(n,o){1&n&&(e.ynx(0),e.YNc(1,ye,3,1,"td",41),e.BQk())}function Ne(n,o){if(1&n&&(e.TgZ(0,"td",43),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.qZA()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.user.last_name)}}function Ue(n,o){1&n&&(e.ynx(0),e.YNc(1,Ne,3,1,"td",39),e.BQk())}function ke(n,o){if(1&n&&(e.TgZ(0,"td",43),e.TgZ(1,"span",44),e._uU(2),e.qZA(),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngClass",e.WLB(2,Z,"admin"==t.role,"member"==t.role)),e.xp6(1),e.Oqu(t.role)}}function Oe(n,o){1&n&&(e.ynx(0),e.YNc(1,ke,3,5,"td",39),e.BQk())}function Se(n,o){if(1&n&&(e.TgZ(0,"td",43),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.qZA()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.user.phone?t.user.phone:"---")}}function Ye(n,o){1&n&&(e.ynx(0),e.YNc(1,Se,3,1,"td",39),e.BQk())}function Ee(n,o){if(1&n&&(e.TgZ(0,"td",43),e.TgZ(1,"span",45),e._uU(2),e.qZA(),e.qZA()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.user.email?t.user.email:"---")}}function Be(n,o){1&n&&(e.ynx(0),e.YNc(1,Ee,3,1,"td",39),e.BQk())}function Ie(n,o){if(1&n&&(e.TgZ(0,"td",43),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.qZA()),2&n){const t=o.$implicit,i=e.oxw().$implicit,r=e.oxw(3);e.xp6(2),e.hij(" ",t[r._concatColumnString(i)],"")}}function De(n,o){if(1&n&&(e.ynx(0,37),e.YNc(1,we,2,1,"th",38),e.YNc(2,Qe,2,0,"ng-container",14),e.YNc(3,Ue,2,0,"ng-container",14),e.YNc(4,Oe,2,0,"ng-container",14),e.YNc(5,Ye,2,0,"ng-container",14),e.YNc(6,Be,2,0,"ng-container",14),e.YNc(7,Ie,3,1,"td",39),e.BQk()),2&n){const t=o.$implicit,i=o.index;e.Q6J("matColumnDef",t),e.xp6(2),e.Q6J("ngIf",0===i),e.xp6(1),e.Q6J("ngIf","last name"==t),e.xp6(1),e.Q6J("ngIf","role"==t),e.xp6(1),e.Q6J("ngIf","phone"==t),e.xp6(1),e.Q6J("ngIf","email"==t)}}function Fe(n,o){1&n&&e._UZ(0,"tr",46)}function Pe(n,o){if(1&n&&e._UZ(0,"tr",47),2&n){const t=o.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.VKq(1,h,i.selection.isSelected(t)))}}function Le(n,o){if(1&n&&(e.TgZ(0,"tr",48),e.TgZ(1,"td",49),e._uU(2),e.qZA(),e.qZA()),2&n){const t=e.oxw(3);e.xp6(2),e.hij(' No data matching the search item: "',t.filterValue,'" ')}}function Re(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"table",51),e.YNc(2,De,8,6,"ng-container",33),e.YNc(3,Fe,1,0,"tr",34),e.YNc(4,Pe,1,3,"tr",35),e.YNc(5,Le,3,1,"tr",36),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("dataSource",t.dataSource),e.xp6(1),e.Q6J("ngForOf",t.displayedColumns),e.xp6(1),e.Q6J("matHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns)}}function je(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",29),e.TgZ(1,"div",30),e.YNc(2,Re,6,4,"ng-container",14),e.TgZ(3,"mat-paginator",31),e.NdJ("page",function(r){return e.CHM(t),e.oxw().pageChanged(r)}),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",0!==t.firstTimersList.length),e.xp6(1),e.Q6J("pageIndex",t.currentPage)("pageSize",t.pageSize)("ngClass",e.VKq(4,x,0==t.firstTimersList.length))}}let $e=(()=>{class n{constructor(t,i,r){this.reportService=t,this.exportService=i,this._location=r,this.pageSize=50,this.currentPage=0,this.firstTimersList=[],this.regularMemberList=[],this.newConvertList=[],this._loading_=!1,this._printElement=g.sn,this._setDateQuery=g.JT,this.dateQuery=new Date,this._concatColumnString=g.kA,this.dataSource=new _.by,this.selection=new k.Ov(!0,[]),this.column=["first name","last name","role","phone","email"]}ngOnInit(){this.getMemberShipJournal(),this.displayedColumns=this.column}ngAfterViewInit(){window.scrollTo(0,0),this.dataSource.paginator=this.paginator}gotoBack(){this._location.back()}onPreview(t){switch(this._query=t,t){case t="reg_members":return this.dataSource=new _.by(this.regularMemberList);case t="first-timer":return this.dataSource=new _.by(this.firstTimersList);case t="new-convert":return this.dataSource=new _.by(this.newConvertList);default:return}}getMemberShipJournal(t){this._loading_=!0;let i=(0,g.JT)(t);this.reportService.fetchMembershipJournal("membership_journal",i).subscribe(r=>{this._loading_=!1;const{first_timers:c,regular_members:l,new_converts:on}=r;this.firstTimersList=c,this.newConvertList=on,this.regularMemberList=l},r=>{this._loading_=!1,C().fire("Server error",r,"error"),this.firstTimersList=[],this.newConvertList=[],this.regularMemberList=[]})}exportFirstTimersToExcel(){const t=[],i={data:[{A:"FIRST TIMERS DATA"},{A:"#",B:"First Name",C:"Last Name",D:"Phone Number",E:"Membership Information",F:"Convert Status"}],skipHeader:!0};this.firstTimersList.forEach(r=>{i.data.push({A:r.id,B:r.first_name,C:r.last_name,D:r.phone,E:r.membership_info,F:r.convert_status})}),t.push(i),this.exportService.exportTableElmToExcel(t,"First Timer data")}exportNewConvertsToExcel(){const t=[],i={data:[{A:"CONVERTS DATA"},{A:"#",B:"First Name",C:"Last Name",D:"Membership Info",E:"Convert Status"}],skipHeader:!0};this.newConvertList.forEach(r=>{i.data.push({A:r.id,B:r.first_name,C:r.last_name,D:r.membership_info,E:r.convert_status})}),t.push(i),this.exportService.exportTableElmToExcel(t,"New converts Journal Data")}exportRegularMembersToExcel(){const t=[],i={data:[{A:"REGULAR MEMBERS JOURNAL DATA"},{A:"#",B:"First Name",C:"Last Name",D:"Phone",E:"Email"}],skipHeader:!0};this.regularMemberList.forEach(r=>{i.data.push({A:r.id,B:r.user.first_name,C:r.user.last_name,D:r.user.phone,E:r.user.email})}),t.push(i),this.exportService.exportTableElmToExcel(t,"Regular members Journal Data")}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(v),e.Y36(q.j),e.Y36(m.Ye))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-membership-journal"]],viewQuery:function(t,i){if(1&t&&e.Gf(A.NW,5),2&t){let r;e.iGM(r=e.CRH())&&(i.paginator=r.first)}},decls:39,vars:9,consts:[[1,"header","d-flex","align-items-center","mb-4"],[1,"d-flex","align-items-center","cursor","me-3",3,"click"],["mat-icon-button","",1,"me-2","return-link-wrap"],[1,"title-sm"],[1,"title","md"],[1,"bg-white","p-3"],[1,"membership","py-3","px-2"],[1,"my-3"],["matInput","",3,"matDatepicker","dateChange"],["ref",""],["matSuffix","",3,"for"],["datepicker",""],["mat-button","","matDatepickerCancel",""],["mat-raised-button","","color","primary","matDatepickerApply",""],[4,"ngIf"],[1,"grid","grid--1fr--1fr","gap","mt-5"],["regMembers",""],["firstTimer",""],["newConvert",""],[1,"journal"],[1,"d-flex","align-items-center","justify-content-between"],[1,"title","md","pt-3"],[1,"cursor",3,"mat-menu-trigger-for"],["menu","matMenu"],["type","button","mat-menu-item","",3,"click"],["type","button","mat-menu-item",""],[1,"d-flex","align-items-center","justify-content-between","py-3"],[1,""],[4,"ngTemplateOutlet"],[1,"overflow--wrap","_visible"],[1,"table-wrapper","tbl-wrap"],["showFirstLastButton","",1,"visibility",3,"pageIndex","pageSize","ngClass","page"],["mat-table","","id","print-reg-members",1,"table","custom-table","w--100",2,"width","100%",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[3,"matColumnDef"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell",""],["style","padding-left: 3.5em",4,"matCellDef"],[2,"padding-left","3.5em"],["mat-cell",""],[1,"tag",3,"ngClass"],[1,"lowercase"],["mat-header-row",""],["mat-row","",3,"ngClass"],[1,"mat-row"],["colspan","4",1,"mat-cell"],["mat-table","","id","print-first-timer",1,"table","custom-table","w--100",2,"width","100%",3,"dataSource"],["mat-table","","id","print-new-convert",1,"table","custom-table","w--100",2,"width","100%",3,"dataSource"]],template:function(t,i){if(1&t){const r=e.EpF();e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.NdJ("click",function(){return i.gotoBack()}),e.TgZ(2,"button",2),e.TgZ(3,"mat-icon"),e._uU(4,"west"),e.qZA(),e.qZA(),e.TgZ(5,"div",3),e._uU(6,"Back"),e.qZA(),e.qZA(),e.TgZ(7,"div",4),e._uU(8,"Membership Journal"),e.qZA(),e.qZA(),e.TgZ(9,"div",5),e.TgZ(10,"section",6),e.TgZ(11,"div",7),e.TgZ(12,"mat-form-field"),e.TgZ(13,"mat-label"),e._uU(14,"Query by date"),e.qZA(),e.TgZ(15,"input",8,9),e.NdJ("dateChange",function(){e.CHM(r);const l=e.MAs(16);return i.getMemberShipJournal(l.value)}),e.qZA(),e._UZ(17,"mat-datepicker-toggle",10),e.TgZ(18,"mat-datepicker",null,11),e.TgZ(20,"mat-datepicker-actions"),e.TgZ(21,"button",12),e._uU(22,"Cancel"),e.qZA(),e.TgZ(23,"button",13),e._uU(24," Apply "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(25,Y,2,0,"ng-container",14),e.TgZ(26,"div",15),e.YNc(27,E,20,1,"ng-container",14),e.YNc(28,B,20,1,"ng-container",14),e.YNc(29,I,20,1,"ng-container",14),e.qZA(),e.qZA(),e.qZA(),e.YNc(30,F,2,1,"ng-container",14),e.YNc(31,L,2,1,"ng-container",14),e.YNc(32,j,2,1,"ng-container",14),e.YNc(33,se,4,6,"ng-template",null,16,e.W1O),e.YNc(35,qe,4,6,"ng-template",null,17,e.W1O),e.YNc(37,je,4,6,"ng-template",null,18,e.W1O)}if(2&t){const r=e.MAs(19);e.xp6(15),e.Q6J("matDatepicker",r),e.xp6(2),e.Q6J("for",r),e.xp6(8),e.Q6J("ngIf",i._loading_),e.xp6(2),e.Q6J("ngIf",!i._loading_),e.xp6(1),e.Q6J("ngIf",!i._loading_),e.xp6(1),e.Q6J("ngIf",!i._loading_),e.xp6(1),e.Q6J("ngIf","reg_members"==i._query),e.xp6(1),e.Q6J("ngIf","first-timer"==i._query),e.xp6(1),e.Q6J("ngIf","new-convert"==i._query)}},directives:[w.lW,f.Hw,u.KE,u.hX,y.Nt,s.hl,s.nW,u.R9,s.Mq,s.M5,s.dp,s.DK,m.O5,Q.m,p.p6,p.VK,p.OP,m.tP,A.NW,m.mk,_.BZ,m.sg,_.as,_.nj,_.Ee,_.w1,_.fO,_.Dz,_.ge,_.ev,_.XQ,_.Gk],styles:[".membership[_ngcontent-%COMP%]   .gap[_ngcontent-%COMP%]{grid-gap:1em;gap:1em}.membership[_ngcontent-%COMP%]   .gap[_ngcontent-%COMP%]   .journal[_ngcontent-%COMP%]{padding:.5em 1.2em;border-radius:10px;background:#fff;transition:.5s ease-in-out;box-shadow:0 1px 15px 2px #e0e0e0}.membership[_ngcontent-%COMP%]   .gap[_ngcontent-%COMP%]   .journal[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;margin:0;color:#343a4080}"]}),n})();function He(n,o){1&n&&(e.ynx(0),e._UZ(1,"app-loading-roller"),e.BQk())}function ze(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",16),e.TgZ(2,"h3",17),e._uU(3,"SMS Message"),e.qZA(),e.TgZ(4,"div",18),e.TgZ(5,"p",19),e._uU(6," View and download report of the regular members for the period selected "),e.qZA(),e.TgZ(7,"div",20),e.TgZ(8,"button",21),e._uU(9,"Print"),e.qZA(),e.TgZ(10,"div",22),e.TgZ(11,"button",23),e._uU(12," Export as "),e.qZA(),e.TgZ(13,"mat-menu",null,24),e.TgZ(15,"button",25),e.NdJ("click",function(){return e.CHM(t),e.oxw().exportSmsToExcel()}),e._uU(16," Download as Excel "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.BQk()}if(2&n){const t=e.MAs(14);e.xp6(11),e.Q6J("matMenuTriggerFor",t)}}function Ve(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",16),e.TgZ(2,"h3",17),e._uU(3,"Email Message"),e.qZA(),e.TgZ(4,"div",26),e.TgZ(5,"p",19),e._uU(6,"See in detail the number of email messsages sent."),e.qZA(),e.TgZ(7,"div",20),e.TgZ(8,"button",21),e._uU(9,"Print"),e.qZA(),e.TgZ(10,"div",22),e.TgZ(11,"button",23),e._uU(12," Export as "),e.qZA(),e.TgZ(13,"mat-menu",null,27),e.TgZ(15,"button",25),e.NdJ("click",function(){return e.CHM(t),e.oxw().exportEmailToExcel()}),e._uU(16," Download as Excel "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.BQk()}if(2&n){const t=e.MAs(14);e.xp6(11),e.Q6J("matMenuTriggerFor",t)}}let Ke=(()=>{class n{constructor(t,i,r){this.reportService=t,this.exportService=i,this._location=r,this.emailMessagesList=[],this.smsMessagesList=[],this.newConvertList=[],this._loading_=!1,this._printElement=g.sn,this._setDateQuery=g.JT}ngOnInit(){this.getMessageJournal()}gotoBack(){this._location.back()}getMessageJournal(t){this._loading_=!0;let i=(0,g.JT)(t);this.reportService.fetchJournal("message_journal",i).subscribe(r=>{this._loading_=!1;const{message_by_mail:c,message_by_sms:l}=r;this.emailMessagesList=c,this.smsMessagesList=l},r=>{this._loading_=!1,C().fire("Server error",r,"error"),this.emailMessagesList=[],this.smsMessagesList=[]})}exportEmailToExcel(){const t=[],i={data:[{A:"MEDIA DATA"},{A:"#",B:"From",C:"To",D:"Message"}],skipHeader:!0};this.emailMessagesList.forEach(r=>{let c=r.to.map(l=>l);i.data.push({A:r.id,B:r.from,C:c.toString(),D:r.message})}),t.push(i),this.exportService.exportTableElmToExcel(t,"Email message journal data")}exportSmsToExcel(){const t=[],i={data:[{A:"MEDIA DATA"},{A:"#",B:"From",C:"To",D:"Message"}],skipHeader:!0};this.smsMessagesList.forEach(r=>{let c=r.to.map(l=>l);i.data.push({A:r.id,B:r.from,C:c.toString(),D:r.message})}),t.push(i),this.exportService.exportTableElmToExcel(t,"Email message journal data")}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(v),e.Y36(q.j),e.Y36(m.Ye))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-messages-journal"]],decls:29,vars:5,consts:[[1,"header","d-flex","align-items-center","mb-4"],[1,"d-flex","align-items-center","cursor","me-3",3,"click"],["mat-icon-button","",1,"me-2","return-link-wrap"],[1,"title-sm"],[1,"title","md"],[1,"bg-white","p-3"],[1,"message","py-3","px-2"],[1,"my-3"],["matInput","",3,"matDatepicker","dateChange"],["ref",""],["matSuffix","",3,"for"],["datepicker",""],["mat-button","","matDatepickerCancel",""],["mat-raised-button","","color","primary","matDatepickerApply",""],[4,"ngIf"],[1,"grid","grid--1fr--1fr","gap","mt-5"],[1,"journal"],[1,"title","md","pt-3"],[1,"d-md-flex","align-items-center","justify-content-between","py-3"],[1,""],[1,"btn-wrap","d-flex"],["mat-stroked-button","",1,"mx-2"],[1,"ms-2"],["mat-stroked-button","",1,"mat-stroke-secondary",3,"matMenuTriggerFor"],["exportAsSms","matMenu"],["mat-menu-item","",3,"click"],[1,"d-flex","align-items-center","justify-content-between","py-3"],["exportAsEmail","matMenu"]],template:function(t,i){if(1&t){const r=e.EpF();e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.NdJ("click",function(){return i.gotoBack()}),e.TgZ(2,"button",2),e.TgZ(3,"mat-icon"),e._uU(4,"west"),e.qZA(),e.qZA(),e.TgZ(5,"div",3),e._uU(6,"Back"),e.qZA(),e.qZA(),e.TgZ(7,"div",4),e._uU(8,"Messages Journal"),e.qZA(),e.qZA(),e.TgZ(9,"div",5),e.TgZ(10,"section",6),e.TgZ(11,"div",7),e.TgZ(12,"mat-form-field"),e.TgZ(13,"mat-label"),e._uU(14,"Query by date"),e.qZA(),e.TgZ(15,"input",8,9),e.NdJ("dateChange",function(){e.CHM(r);const l=e.MAs(16);return i.getMessageJournal(l.value)}),e.qZA(),e._UZ(17,"mat-datepicker-toggle",10),e.TgZ(18,"mat-datepicker",null,11),e.TgZ(20,"mat-datepicker-actions"),e.TgZ(21,"button",12),e._uU(22,"Cancel"),e.qZA(),e.TgZ(23,"button",13),e._uU(24," Apply "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(25,He,2,0,"ng-container",14),e.TgZ(26,"div",15),e.YNc(27,ze,17,1,"ng-container",14),e.YNc(28,Ve,17,1,"ng-container",14),e.qZA(),e.qZA(),e.qZA()}if(2&t){const r=e.MAs(19);e.xp6(15),e.Q6J("matDatepicker",r),e.xp6(2),e.Q6J("for",r),e.xp6(8),e.Q6J("ngIf",i._loading_),e.xp6(2),e.Q6J("ngIf",!i._loading_),e.xp6(1),e.Q6J("ngIf",!i._loading_)}},directives:[w.lW,f.Hw,u.KE,u.hX,y.Nt,s.hl,s.nW,u.R9,s.Mq,s.M5,s.dp,s.DK,m.O5,Q.m,p.p6,p.VK,p.OP],styles:[".message[_ngcontent-%COMP%]   .gap[_ngcontent-%COMP%]{grid-gap:1em;gap:1em}.message[_ngcontent-%COMP%]   .gap[_ngcontent-%COMP%]   .journal[_ngcontent-%COMP%]{padding:.5em 1.2em;border-radius:10px;background:#fff;transition:.5s ease-in-out;box-shadow:0 1px 15px 2px #e0e0e0}.message[_ngcontent-%COMP%]   .gap[_ngcontent-%COMP%]   .journal[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;margin:0;color:#343a4080}"]}),n})();function We(n,o){if(1&n&&(e.TgZ(0,"div",7),e.TgZ(1,"div",8),e._UZ(2,"img",9),e.TgZ(3,"div",10),e.TgZ(4,"span"),e.TgZ(5,"mat-icon"),e._uU(6,"more_horiz"),e.qZA(),e.qZA(),e.TgZ(7,"mat-menu",null,11),e.TgZ(9,"button",12),e._uU(10," View report "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(11,"h3",13),e._uU(12),e.qZA(),e.TgZ(13,"p",14),e._uU(14),e.qZA(),e.qZA()),2&n){const t=o.$implicit,i=e.MAs(8);e.xp6(2),e.Q6J("src","assets/img/svg/"+t.icon+".svg",e.LSH)("alt",t.title),e.xp6(1),e.Q6J("mat-menu-trigger-for",i),e.xp6(6),e.Q6J("routerLink",t.url),e.xp6(3),e.Oqu(t.title),e.xp6(2),e.Oqu(t.desc)}}const Ge=[{path:"",component:(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-reporting"]],decls:1,vars:0,template:function(t,i){1&t&&e._UZ(0,"router-outlet")},directives:[d.lC],styles:[""]}),n})(),children:[{path:"",component:(()=>{class n{constructor(){this.reportsItems=[]}ngOnInit(){this.getReportsItems()}getReportsItems(){return this.reportsItems=[{title:"Membership Journal",desc:"Find more insight on regular members, first timers, new converts and much more",url:"/portal/reporting/membership-journal",icon:"plus-heart"},{title:"Financial Journal",desc:"Find all your balance sheet information and more",url:"/portal/reporting/financial-journal",icon:"reconciliation"},{title:"Messages Journal",desc:"Text Messages and Email Messages",url:"/portal/reporting/messages-journal",icon:"message-mail"},{title:"Member Connect",desc:"Web connect and mobile connect report",url:"/portal/reporting/member-connect",icon:"message-mail"},{title:"Login Activity",desc:"User management timeline",url:"/portal/reporting/login-activity",icon:"login-svgrepo-com"}]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-overview"]],decls:12,vars:1,consts:[[1,"report-overview"],[1,"header","d-flex","align-items-center","jsutify-content-between","mb-2"],[1,"title"],[1,"welcome-note","f12","txt-grey"],[1,"card-list-wrap"],[1,"items-wrap","grid","grid--1fr--1fr"],["class","card",4,"ngFor","ngForOf"],[1,"card"],[1,"d-flex","justify-content-between","align-items-center"],[1,"icon",3,"src","alt"],[1,"cursor",3,"mat-menu-trigger-for"],["menu","matMenu"],["type","button","mat-menu-item","",3,"routerLink"],[1,"title","md","mt-4"],[1,"f14","txt-grey"]],template:function(t,i){1&t&&(e.TgZ(0,"section",0),e.TgZ(1,"div",1),e.TgZ(2,"h2",2),e._uU(3,"Church Records Reporting"),e.qZA(),e.qZA(),e.TgZ(4,"div"),e.TgZ(5,"p",3),e._uU(6," You can view, and download reports for church leaders at a time so you save time and "),e._UZ(7,"br"),e._uU(8,"focus on what really matters, your firm and clients "),e.qZA(),e.qZA(),e.TgZ(9,"div",4),e.TgZ(10,"div",5),e.YNc(11,We,15,6,"div",6),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(11),e.Q6J("ngForOf",i.reportsItems))},directives:[m.sg,p.p6,f.Hw,p.VK,p.OP,d.rH],styles:[".report-overview[_ngcontent-%COMP%]   .card-list-wrap[_ngcontent-%COMP%]   .items-wrap[_ngcontent-%COMP%]{grid-gap:1em;gap:1em}.report-overview[_ngcontent-%COMP%]   .card-list-wrap[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{padding:1em;height:208px;border:none;border-radius:10px;box-shadow:0 1px 15px 2px #d2daf5}.report-overview[_ngcontent-%COMP%]   .card-list-wrap[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:40px}"]}),n})()},{path:"financial-journal",component:N},{path:"membership-journal",component:$e},{path:"messages-journal",component:Ke},{path:"**",redirectTo:""}]}];let Xe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[d.Bz.forChild(Ge)],d.Bz]}),n})();var en=a(6314),nn=a(8097);let tn=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[m.ez,Xe,nn.h,en.a]]}),n})()}}]);